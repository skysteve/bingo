{"version":3,"file":null,"sources":["../../tmp/display/index.js"],"sourcesContent":["function speakNumber(num) {\n    const numString = num.toString();\n    let text = numString;\n    // break the numbers out to the digits (e.g. 24. 2. 4. 24)\n    // the . ensures a pause between numbers\n    if (numString.length > 1) {\n        for (let i = 0; i < numString.length; i++) {\n            text += `. ${numString.charAt(i)}`;\n        }\n        text += `.. ${numString}`;\n    }\n    const msg = new window.SpeechSynthesisUtterance(text);\n    window.speechSynthesis.speak(msg);\n}\ndocument.addEventListener('DOMContentLoaded', () => {\n    const channel = new window.BroadcastChannel('__BUS_NAME__');\n    const elLatest = document.querySelector('#latest_number');\n    const elTable = document.querySelector('#tableLastCalled');\n    const elToast = document.querySelector('#toastMsg');\n    // listen for messages from the caller and update the display\n    channel.onmessage = (e) => {\n        let toastData;\n        switch (e.data.messageType) {\n            case 'caller_connected':\n                toastData = {\n                    message: 'Bingo Caller is connected',\n                    timeout: 3000\n                };\n                elToast.MaterialSnackbar.showSnackbar(toastData);\n                // tell the caller we're alive\n                channel.postMessage({\n                    messageType: 'display_connected'\n                });\n                break;\n            case 'caller_disconnected':\n                toastData = {\n                    message: 'Bingo Caller has disconnected',\n                    timeout: 10000\n                };\n                elToast.MaterialSnackbar.showSnackbar(toastData);\n                break;\n            case 'called':\n                elLatest.textContent = e.data.number;\n                elTable.setCalled(e.data.number);\n                // speakNumber(e.data.number);\n                break;\n            case 'reset':\n                elTable.reset();\n                elLatest.textContent = '-';\n                break;\n            case 'active_game':\n                // if our display re-connects we get an update of the current state of the game, so replicate it\n                elTable.reset();\n                e.data.calledNumbers.forEach(number => elTable.setCalled(number));\n                elLatest.textContent = e.data.latestNumber || '-';\n                break;\n            default:\n                console.warn('Unknown message type', e.data);\n        }\n    };\n    window.addEventListener('beforeunload', () => {\n        channel.postMessage({\n            messageType: 'display_disconnected'\n        });\n    });\n    channel.postMessage({\n        messageType: 'display_connected'\n    });\n});\n"],"names":[],"mappings":";;;AAcA,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,MAAM;IAChD,MAAM,OAAO,GAAG,IAAI,MAAM,CAAC,gBAAgB,CAAC,cAAc,CAAC,CAAC;IAC5D,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;IAC1D,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAAC,CAAC;IAC3D,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;;IAEpD,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC,KAAK;QACvB,IAAI,SAAS,CAAC;QACd,QAAQ,CAAC,CAAC,IAAI,CAAC,WAAW;YACtB,KAAK,kBAAkB;gBACnB,SAAS,GAAG;oBACR,OAAO,EAAE,2BAA2B;oBACpC,OAAO,EAAE,IAAI;iBAChB,CAAC;gBACF,OAAO,CAAC,gBAAgB,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;;gBAEjD,OAAO,CAAC,WAAW,CAAC;oBAChB,WAAW,EAAE,mBAAmB;iBACnC,CAAC,CAAC;gBACH,MAAM;YACV,KAAK,qBAAqB;gBACtB,SAAS,GAAG;oBACR,OAAO,EAAE,+BAA+B;oBACxC,OAAO,EAAE,KAAK;iBACjB,CAAC;gBACF,OAAO,CAAC,gBAAgB,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;gBACjD,MAAM;YACV,KAAK,QAAQ;gBACT,QAAQ,CAAC,WAAW,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;gBACrC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;gBAEjC,MAAM;YACV,KAAK,OAAO;gBACR,OAAO,CAAC,KAAK,EAAE,CAAC;gBAChB,QAAQ,CAAC,WAAW,GAAG,GAAG,CAAC;gBAC3B,MAAM;YACV,KAAK,aAAa;;gBAEd,OAAO,CAAC,KAAK,EAAE,CAAC;gBAChB,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;gBAClE,QAAQ,CAAC,WAAW,GAAG,CAAC,CAAC,IAAI,CAAC,YAAY,IAAI,GAAG,CAAC;gBAClD,MAAM;YACV;gBACI,OAAO,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;SACpD;KACJ,CAAC;IACF,MAAM,CAAC,gBAAgB,CAAC,cAAc,EAAE,MAAM;QAC1C,OAAO,CAAC,WAAW,CAAC;YAChB,WAAW,EAAE,sBAAsB;SACtC,CAAC,CAAC;KACN,CAAC,CAAC;IACH,OAAO,CAAC,WAAW,CAAC;QAChB,WAAW,EAAE,mBAAmB;KACnC,CAAC,CAAC;CACN,CAAC,CAAC;;"}